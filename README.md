# Alternate UDF

Alternate is user defined function for sphinx.
The function initializes the map (associative array) in form (attribute => counter) before query.
Then during the query sphinx performs this function for each document and increments the internal counter if such attribute already existed.
As result, this counter is appeared for each docid.
This is essentially the position of the document in scope of attribute.

Examples:

```sql
SELECT alternate(company_id) AS alt_pos, sorted_name, company_id FROM product WHERE company_id IN (13497, 12229) ORDER BY company_id ASC, alt_pos ASC;

+---------+------------------------------------------------------------------------------------------------------------------------------------------+------------+
| alt_pos | sorted_name                                                                                                                              | company_id |
+---------+------------------------------------------------------------------------------------------------------------------------------------------+------------+
|       1 | ремонтная смесь мбр400 машинного нанесения, 25кг                                                                                         |      12229 |
|       2 | ремонтный состав для бетона мбр-500 гора хрустальная, 25 кг                                                                              |      12229 |
|       3 | смесь ремонтная для бетона гора хрустальная мбр 300 литьевой тип 25кг                                                                    |      12229 |
|       1 | стул для кафе герцог №2                                                                                                                  |      13497 |
|       2 | стул для столовой №1ш                                                                                                                    |      13497 |
|       3 | вешало напольное № 3ш гардеробное                                                                                                        |      13497 |

SELECT alternate(company_id) AS alt_pos, sorted_name, company_id FROM product WHERE company_id IN (13497, 12229) ORDER BY alt_pos ASC LIMIT 100;
+---------+------------------------------------------------------------------------------------------------------------------------------------------+------------+
| alt_pos | sorted_name                                                                                                                              | company_id |
+---------+------------------------------------------------------------------------------------------------------------------------------------------+------------+
|       1 | стул для кафе герцог №2                                                                                                                  |      13497 |
|       1 | ремонтная смесь мбр400 машинного нанесения, 25кг                                                                                         |      12229 |
|       2 | стул для столовой №1ш                                                                                                                    |      13497 |
|       2 | ремонтный состав для бетона мбр-500 гора хрустальная, 25 кг                                                                              |      12229 |
|       3 | вешало напольное № 3ш гардеробное                                                                                                        |      13497 |
|       3 | смесь ремонтная для бетона гора хрустальная мбр 300 литьевой тип 25кг                                                                    |      12229 |
|       4 | табурет м квадратный (корич-антик)                                                                                                       |      13497 |
|       4 | смесь ремонтная для бетона гора хрустальная мбр 700 25кг литьевой тип                                                                    |      12229 |
|       5 | стул для офиса аскона                                                                                                                    |      13497 |
|       5 | смесь ремонтная для бетона мбр-600 литьевой тип                                                                                          |      12229 |
|       6 | стул офисный серена                                                                                                                      |      13497 |
|       6 | столешницы из кварцевого агломерата для столиков кафе, ресторанов                                                                        |      12229 |
```
